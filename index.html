<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    <title>ZOMERD PRO | Ø¨Ø±Ø§Ø¡ Ø¹Ù…Ø±</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&family=JetBrains+Mono&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />

    <style>
        :root {
            --p: #00d2ff; --bg: #020617; --card: rgba(15, 23, 42, 0.8); 
            --txt: #f8fafc; --border: rgba(0, 210, 255, 0.2); --grad: linear-gradient(135deg, #00d2ff 0%, #0072ff 100%);
        }
        
        * { margin:0; padding:0; box-sizing:border-box; font-family:'Cairo', sans-serif; transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
        body { background: var(--bg); color: var(--txt); display: flex; height: 100vh; overflow: hidden; }

        #particles-js { position: fixed; inset: 0; z-index: -1; }

        /* Ø´Ø±ÙŠØ· Ø¹Ø§Ø¬Ù„ Ù…Ø·ÙˆØ± */
        .ticker-container { background: rgba(0,0,0,0.9); border-bottom: 1px solid var(--border); height: 45px; display: flex; align-items: center; z-index: 100; backdrop-filter: blur(15px); }
        .ticker-label { background: var(--grad); color: #000; padding: 0 20px; font-weight: 900; font-size: 0.8rem; height: 100%; display: flex; align-items: center; z-index: 2; box-shadow: 5px 0 15px rgba(0,0,0,0.5); }
        .ticker-wrapper { flex: 1; overflow: hidden; }
        .ticker-content { display: inline-block; white-space: nowrap; animation: ticker 30s linear infinite; }
        .ticker-content span { margin-right: 50px; color: var(--p); font-size: 0.85rem; font-weight: 600; }
        @keyframes ticker { 0% { transform: translateX(100%); } 100% { transform: translateX(-100%); } }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        aside { width: 280px; background: var(--card); border-left: 1px solid var(--border); display: flex; flex-direction: column; z-index: 1001; backdrop-filter: blur(25px); }
        @media (max-width: 768px) {
            aside { position: fixed; right: -280px; height: 100%; top: 0; }
            aside.open { right: 0; box-shadow: -20px 0 50px rgba(0,0,0,0.9); }
        }

        .nav-link { padding: 15px 25px; border-radius: 15px; cursor: pointer; display: flex; align-items: center; gap: 15px; color: #94a3b8; margin: 8px 15px; border: 1px solid transparent; }
        .nav-link.active { background: var(--grad); color: #000; font-weight: 900; box-shadow: 0 10px 20px rgba(0, 210, 255, 0.3); }
        .nav-link:hover:not(.active) { background: rgba(0, 210, 255, 0.1); color: var(--p); transform: translateX(-5px); }

        main { flex: 1; overflow-y: auto; display: flex; flex-direction: column; background: radial-gradient(circle at top right, rgba(0,210,255,0.05), transparent); }
        header { height: 70px; padding: 0 25px; display: flex; align-items: center; justify-content: space-between; background: rgba(2, 6, 23, 0.8); border-bottom: 1px solid var(--border); position: sticky; top: 0; z-index: 50; backdrop-filter: blur(10px); }

        .menu-btn { font-size: 1.4rem; color: var(--p); cursor: pointer; background: rgba(0,210,255,0.15); border: 1px solid var(--p); padding: 10px 15px; border-radius: 12px; display: none; }
        @media (max-width: 768px) { .menu-btn { display: block; } }

        .section { padding: 25px; display: none; max-width: 1200px; margin: 0 auto; width: 100%; }
        .section.active { display: block; animation: fadeInUp 0.5s ease forwards; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* ÙƒØ±ÙˆØª Ø§Ù„Ø£Ø®Ø¨Ø§Ø± */
        .posts-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; margin-top: 25px; }
        @media (max-width: 600px) { .posts-grid { grid-template-columns: repeat(2, 1fr); gap: 12px; } }

        .post-card { background: var(--card); border-radius: 22px; overflow: hidden; border: 1px solid var(--border); cursor: pointer; position: relative; }
        .post-card:hover { border-color: var(--p); transform: translateY(-8px); box-shadow: 0 15px 35px rgba(0, 210, 255, 0.2); }
        .post-img { width: 100%; height: 180px; object-fit: cover; border-bottom: 1px solid var(--border); }
        @media (max-width: 600px) { .post-img { height: 120px; } }
        .post-info { padding: 15px; }
        .post-info h3 { font-size: 1rem; margin-bottom: 12px; line-height: 1.5; font-weight: 700; color: #fff; }

        /* Ø§Ù„Ø¹Ø¯Ø§Ø¯Ø§Øª */
        .stat-group { display: flex; gap: 10px; }
        .stat-item { font-family: 'JetBrains Mono'; color: var(--p); font-size: 0.75rem; background: rgba(255,255,255,0.05); padding: 4px 10px; border-radius: 8px; border: 1px solid var(--border); }

        /* Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù‚Ø§Ù„ */
        #article-view { position: fixed; inset: 0; background: var(--bg); z-index: 2000; display: none; overflow-y: auto; padding: 20px; backdrop-filter: blur(20px); }
        .article-container { max-width: 900px; margin: 0 auto; background: var(--card); padding: 40px; border-radius: 30px; border: 1px solid var(--border); box-shadow: 0 25px 50px rgba(0,0,0,0.5); }
        @media (max-width: 600px) { .article-container { padding: 20px; } }

        /* Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª */
        .comments-sec { margin-top: 40px; border-top: 1px solid var(--border); padding-top: 30px; }
        .comment-box { display: flex; gap: 15px; background: rgba(255,255,255,0.03); padding: 15px; border-radius: 15px; margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.05); }
        .comment-box img { width: 40px; height: 40px; border-radius: 50%; border: 1px solid var(--p); }

        .btn-action { padding: 15px 30px; background: var(--grad); border: none; border-radius: 15px; font-weight: 900; color: #000; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; }
        .liked { background: #ef4444 !important; color: #fff !important; cursor: default; }

        #login-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.98); z-index: 10000; display: none; align-items: center; justify-content: center; }
    </style>
</head>
<body>
    <div id="particles-js"></div>

    <div id="login-modal">
        <div style="background: var(--card); padding: 50px; border-radius: 35px; border: 1px solid var(--p); text-align: center; max-width: 400px; box-shadow: 0 0 50px var(--p);">
            <h2 style="color:var(--p); font-size: 2rem;">ZOMERD</h2>
            <p style="margin: 25px 0; opacity: 0.8; line-height: 1.6;">Ù„Ù„Ø§Ù†Ø¶Ù…Ø§Ù… Ø¥Ù„Ù‰ Ù…Ø¬ØªÙ…Ø¹ Ø¨Ø±Ø§Ø¡ Ø¹Ù…Ø± ÙˆÙ‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù‚Ø§Ù„Ø§ØªØŒ ÙŠØ±Ø¬Ù‰ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„.</p>
            <div id="g_id_onload" data-client_id="564938368672-s4t74chhfhqjf9qkbi4bp9n06j83gjti.apps.googleusercontent.com" data-callback="onGoogleLogin"></div>
            <div class="g_id_signin" data-type="standard" data-theme="filled_blue" data-shape="pill"></div>
        </div>
    </div>

    <aside id="sidebar">
        <div style="padding: 40px 20px; text-align: center;">
            <h1 style="color: var(--p); font-weight: 900; letter-spacing: 3px;">Ø²Ù…Ø±Ø¯</h1>
        </div>
        <nav>
            <div class="nav-link active" onclick="nav('home', event)"><i class="fa fa-th-large"></i> Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
            <div id="admin-zone" class="nav-link" style="display:none;" onclick="nav('write', event)"><i class="fa fa-feather-pointed"></i> Ø¥Ø¶Ø§ÙØ© Ù…Ø­ØªÙˆÙ‰</div>
            <div class="nav-link" onclick="nav('settings', event)"><i class="fa fa-user-astronaut"></i> Ø§Ù„Ø­Ø³Ø§Ø¨</div>
            <div class="nav-link" onclick="nav('contact', event)"><i class="fa fa-headset"></i> Ø¯Ø¹Ù… ÙÙ†ÙŠ</div>
        </nav>
    </aside>

    <main>
        <div class="ticker-container">
            <div class="ticker-label">Ø¹Ø§Ø¬Ù„ Ø§Ù„Ø¢Ù†</div>
            <div class="ticker-wrapper"><div class="ticker-content" id="ticker"><span>Ø¬Ø§Ø±ÙŠ Ù…Ø²Ø§Ù…Ù†Ø© Ø¢Ø®Ø± Ø§Ù„Ø£Ø®Ø¨Ø§Ø±...</span></div></div>
        </div>

        <header>
            <div style="display:flex; align-items:center; gap:15px;">
                <button class="menu-btn" onclick="toggleMenu()"><i class="fa fa-bars-staggered"></i></button>
                <div id="sec-title" style="font-weight:900; font-size:1.2rem; color:var(--p);">Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</div>
            </div>
            <div id="user-top-info" style="display:none; align-items:center; gap:12px; background: rgba(255,255,255,0.05); padding: 5px 15px; border-radius: 50px; border: 1px solid var(--border);">
                <span id="clock" style="font-family:'JetBrains Mono'; color:var(--p); font-size:0.85rem;">00:00</span>
                <img id="u-avatar" style="width:35px; height:35px; border-radius:50%; border:2px solid var(--p);">
            </div>
        </header>

        <section id="sec-home" class="section active">
            <div style="position:relative;">
                <i class="fa fa-search" style="position:absolute; right:15px; top:18px; color:var(--p);"></i>
                <input type="text" id="search-box" oninput="renderPosts()" placeholder="Ø¹Ù† Ù…Ø§Ø°Ø§ ØªØ¨Ø­Ø« Ø§Ù„ÙŠÙˆÙ…ØŸ" class="inp-field" style="padding-right: 45px; background: rgba(255,255,255,0.03); border-radius: 18px;">
            </div>
            <div id="posts-grid" class="posts-grid"></div>
        </section>

        <section id="sec-write" class="section">
            <div class="article-container">
                <h2 style="color:var(--p); margin-bottom: 25px;">Ù†Ø´Ø± Ù…Ù‚Ø§Ù„ Ø§Ø­ØªØ±Ø§ÙÙŠ</h2>
                <input type="text" id="p-title" class="inp-field" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù‚Ø§Ù„ Ø§Ù„Ø®Ø§Ø·Ù...">
                <div style="display:flex; gap:10px; margin-bottom:20px;">
                    <button onclick="document.getElementById('img-file').click()" class="btn-action" style="flex:1; background:rgba(255,255,255,0.05); color:#fff; border:1px solid var(--border);"><i class="fa fa-image"></i> Ø§Ø±ÙØ¹ ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù</button>
                    <input type="file" id="img-file" hidden onchange="handleImg(this)">
                </div>
                <div id="p-body" class="inp-field" contenteditable="true" style="min-height:300px; padding:20px; line-height:1.8;" placeholder="Ø§Ø¨Ø¯Ø£ Ø³Ø±Ø¯ Ø§Ù„Ù‚ØµØ© Ù‡Ù†Ø§..."></div>
                <button onclick="publish()" class="btn-action" style="width:100%"><i class="fa fa-paper-plane"></i> Ø§Ø¹ØªÙ…Ø§Ø¯ ÙˆÙ†Ø´Ø±</button>
            </div>
        </section>

        <section id="sec-settings" class="section">
            <div class="article-container" style="text-align:center;">
                <img id="u-large-img" style="width:120px; height:120px; border-radius:50%; border:4px solid var(--p); margin-bottom:20px; box-shadow: 0 0 30px var(--p);">
                <h2 id="u-full-name">Ø¨Ø±Ø§Ø¡ Ø¹Ù…Ø±</h2>
                <p id="u-full-email" style="opacity:0.6; margin-bottom:30px;"></p>
                <button onclick="logout()" class="btn-action" style="background:#ef4444; color:#fff; margin:0 auto;">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬</button>
            </div>
        </section>
    </main>

    <div id="article-view">
        <div class="article-container">
            <button onclick="closeArt()" style="background:none; border:none; color:var(--p); cursor:pointer; font-weight:bold; margin-bottom:20px; font-size:1.1rem;"><i class="fa fa-chevron-right"></i> Ø¹ÙˆØ¯Ø©</button>
            <div id="full-post-data"></div>
            
            <div class="comments-sec">
                <h3 style="margin-bottom:20px;"><i class="fa fa-comments"></i> Ø§Ù„ØªØ¹Ù„ÙŠÙ‚Ø§Øª</h3>
                <div id="comments-list"></div>
                <div style="display:flex; gap:10px; margin-top:20px;">
                    <input type="text" id="comment-input" class="inp-field" style="margin-bottom:0;" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ Ù‡Ù†Ø§...">
                    <button onclick="sendComment()" class="btn-action" style="padding:10px 20px;"><i class="fa fa-send"></i></button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyAt16kYfN4cNHfTwbdr3KOGbcQJlmE45tg",
            authDomain: "zomerd-new.firebaseapp.com",
            projectId: "zomerd-new",
            storageBucket: "zomerd-new.firebasestorage.app",
            messagingSenderId: "52188666382",
            appId: "1:52188666382:web:7879a8c671af9329f67a5f"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const OWNER = "bo2584668@gmail.com";
        
        let user = JSON.parse(localStorage.getItem('zomerd_user')) || null;
        let posts = [];
        let currentArtId = "";
        let upImg = "";
        let liked = JSON.parse(localStorage.getItem('z_likes')) || [];

        function init() {
            if(user) {
                document.getElementById('user-top-info').style.display = 'flex';
                document.getElementById('u-avatar').src = user.picture;
                document.getElementById('u-large-img').src = user.picture;
                document.getElementById('u-full-name').innerText = user.name;
                document.getElementById('u-full-email').innerText = user.email;
                if(user.email === OWNER) document.getElementById('admin-zone').style.display = 'flex';
            }
            particlesJS('particles-js', { "particles": { "number": { "value": 40 }, "color": { "value": "#00d2ff" }, "move": { "speed": 1.5 }, "line_linked": { "opacity": 0.1 } } });
            fetchData();
            updateClock();
            setInterval(updateClock, 1000);
        }

        function updateClock() { document.getElementById('clock').innerText = new Date().toLocaleTimeString('ar-EG', {hour:'2-digit', minute:'2-digit'}); }

        async function handleImg(i) {
            const fd = new FormData(); fd.append("image", i.files[0]);
            const res = await fetch("https://api.imgbb.com/1/upload?key=22d566497cb5778087e8dd132dc8116d", { method: "POST", body: fd });
            const d = await res.json(); upImg = d.data.url; alert("Ø§Ù„ØµÙˆØ±Ø© Ø¬Ø§Ù‡Ø²Ø©!");
        }

        async function publish() {
            const t = document.getElementById('p-title').value;
            const b = document.getElementById('p-body').innerHTML;
            if(!t || !b) return;
            await db.collection("posts").add({ title: t, content: b, image: upImg, views: 0, likes: 0, comments: [], time: firebase.firestore.FieldValue.serverTimestamp() });
            alert("ØªÙ… Ø§Ù„Ù†Ø´Ø± Ø¨Ù†Ø¬Ø§Ø­!"); nav('home');
        }

        function fetchData() {
            db.collection("posts").orderBy("time", "desc").onSnapshot(snap => {
                posts = []; let tick = "";
                snap.forEach(doc => {
                    posts.push({id: doc.id, ...doc.data()});
                    tick += `<span>ğŸ”¥ ${doc.data().title}</span>`;
                });
                document.getElementById('ticker').innerHTML = tick;
                renderPosts();
            });
        }

        function renderPosts() {
            const grid = document.getElementById('posts-grid');
            const search = document.getElementById('search-box').value.toLowerCase();
            grid.innerHTML = '';
            posts.filter(p => p.title.toLowerCase().includes(search)).forEach(p => {
                grid.innerHTML += `
                    <div class="post-card" onclick="openArt('${p.id}')">
                        <img src="${p.image}" class="post-img">
                        <div class="post-info">
                            <h3>${p.title}</h3>
                            <div class="stat-group">
                                <div class="stat-item"><i class="fa fa-eye"></i> <span class="counter" data-target="${p.views}">0</span></div>
                                <div class="stat-item"><i class="fa fa-heart"></i> <span class="counter" data-target="${p.likes}">0</span></div>
                                <div class="stat-item"><i class="fa fa-comment"></i> ${p.comments ? p.comments.length : 0}</div>
                            </div>
                        </div>
                    </div>`;
            });
            runCounters();
        }

        function runCounters() {
            document.querySelectorAll('.counter').forEach(el => {
                const target = +el.dataset.target;
                let c = 0;
                const i = setInterval(() => {
                    c += Math.ceil(target/15);
                    if(c >= target) { el.innerText = target; clearInterval(i); }
                    else el.innerText = c;
                }, 50);
            });
        }

        async function openArt(id) {
            if(!user) { document.getElementById('login-modal').style.display='flex'; return; }
            currentArtId = id;
            const p = posts.find(x => x.id === id);
            
            // Ø²ÙŠØ§Ø¯Ø© Ù…Ø´Ø§Ù‡Ø¯Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ©
            db.collection("posts").doc(id).update({ views: firebase.firestore.FieldValue.increment(1) });

            const hasLiked = liked.includes(id);
            document.getElementById('full-post-data').innerHTML = `
                <img src="${p.image}" style="width:100%; border-radius:20px; margin-bottom:25px; border:1px solid var(--border);">
                <h1 style="color:var(--p); margin-bottom:15px; font-size:1.8rem;">${p.title}</h1>
                <div style="line-height:2; font-size:1.1rem; color:#cbd5e1; margin-bottom:30px;">${p.content}</div>
                <button id="l-btn" onclick="hitLike('${id}')" class="btn-action ${hasLiked ? 'liked' : ''}" ${hasLiked ? 'disabled' : ''}>
                    ${hasLiked ? '<i class="fa fa-check"></i> ØªÙ… Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨' : '<i class="fa fa-heart"></i> Ø£Ø¹Ø¬Ø¨Ù†ÙŠ'}
                </button>
            `;
            
            loadComments(p.comments || []);
            document.getElementById('article-view').style.display = 'block';
        }

        function loadComments(list) {
            const div = document.getElementById('comments-list');
            div.innerHTML = list.length ? '' : '<p style="opacity:0.5; text-align:center;">Ù„Ø§ ØªÙˆØ¬Ø¯ ØªØ¹Ù„ÙŠÙ‚Ø§Øª Ø¨Ø¹Ø¯ØŒ ÙƒÙ† Ø£ÙˆÙ„ Ø§Ù„Ù…Ø¹Ù„Ù‚ÙŠÙ†!</p>';
            list.forEach(c => {
                div.innerHTML += `
                    <div class="comment-box">
                        <img src="${c.uimg}">
                        <div>
                            <div style="font-weight:bold; color:var(--p); font-size:0.8rem;">${c.uname}</div>
                            <div style="font-size:0.9rem; margin-top:3px;">${c.text}</div>
                        </div>
                    </div>`;
            });
        }

        async function sendComment() {
            const txt = document.getElementById('comment-input').value;
            if(!txt) return;
            const cObj = { uname: user.name, uimg: user.picture, text: txt, time: Date.now() };
            await db.collection("posts").doc(currentArtId).update({ comments: firebase.firestore.FieldValue.arrayUnion(cObj) });
            document.getElementById('comment-input').value = '';
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù‚Ø§Ù„ Ø§Ù„Ù…ÙØªÙˆØ­
            const doc = await db.collection("posts").doc(currentArtId).get();
            loadComments(doc.data().comments);
        }

        async function hitLike(id) {
            if(liked.includes(id)) return;
            await db.collection("posts").doc(id).update({ likes: firebase.firestore.FieldValue.increment(1) });
            liked.push(id);
            localStorage.setItem('z_likes', JSON.stringify(liked));
            const btn = document.getElementById('l-btn');
            btn.classList.add('liked'); btn.innerHTML = '<i class="fa fa-check"></i> ØªÙ… Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨'; btn.disabled = true;
        }

        function nav(id, e) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
            document.getElementById('sec-' + id).classList.add('active');
            if(e) e.currentTarget.classList.add('active');
            if(window.innerWidth < 768) toggleMenu();
        }

        function closeArt() { document.getElementById('article-view').style.display='none'; }
        function toggleMenu() { document.getElementById('sidebar').classList.toggle('open'); }
        function onGoogleLogin(res) {
            user = JSON.parse(atob(res.credential.split('.')[1]));
            localStorage.setItem('zomerd_user', JSON.stringify(user));
            location.reload();
        }
        function logout() { localStorage.clear(); location.reload(); }
        window.onload = init;
    </script>
</body>
</html>
